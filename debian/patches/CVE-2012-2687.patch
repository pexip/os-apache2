Description: fix XSS vulnerability in mod_negotiation
Origin: upstream, http://svn.apache.org/viewvc?view=revision&revision=1349905

Index: apache2-2.2.22/modules/mappers/mod_negotiation.c
===================================================================
--- apache2-2.2.22.orig/modules/mappers/mod_negotiation.c	2011-09-08 11:59:38.000000000 -0400
+++ apache2-2.2.22/modules/mappers/mod_negotiation.c	2012-11-06 14:10:17.510989590 -0500
@@ -2658,9 +2658,9 @@
          * need to change the calculation of max_vlist_array above.
          */
         *((const char **) apr_array_push(arr)) = "<li><a href=\"";
-        *((const char **) apr_array_push(arr)) = filename;
+        *((const char **) apr_array_push(arr)) = ap_escape_path_segment(r->pool, filename);
         *((const char **) apr_array_push(arr)) = "\">";
-        *((const char **) apr_array_push(arr)) = filename;
+        *((const char **) apr_array_push(arr)) = ap_escape_html(r->pool, filename);
         *((const char **) apr_array_push(arr)) = "</a> ";
         *((const char **) apr_array_push(arr)) = description;
 
